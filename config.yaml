programs:
  # Logger program - bash script
  logger:
    cmd: "/bin/bash /goinfre/yel-mass/taskmaster/scripts/logger.sh"
    numprocs: 1
    umask: 026
    workingdir: /goinfre/yel-mass/taskmaster
    autostart: true
    autorestart: always
    exitcodes: [0]
    startretries: 3
    starttime: 2
    stopsignal: TERM
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/logger.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/logger.stderr
    env:
      STARTED_BY: kamui
      LOG_INTERVAL: "5"

  # Worker - Python with proper output (FIXED)
  worker:
    cmd: "/bin/bash /goinfre/yel-mass/taskmaster/scripts/worker.sh"
    numprocs: 3
    umask: 022
    workingdir: /goinfre/yel-mass/taskmaster
    autostart: true
    autorestart: never
    exitcodes: [0, 2, 3, 4, 1]
    startretries: 3
    starttime: 3
    stopsignal: INT
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/worker.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/worker.stderr
    env:
      WORKER_ID: "1"
      ENVIRONMENT: "production"

  # Ping monitor - advanced network checker
  ping_monitor:
    cmd: "/bin/bash /goinfre/yel-mass/taskmaster/scripts/ping_monitor.sh"
    numprocs: 1
    umask: 022
    workingdir: /goinfre/yel-mass/taskmaster
    autostart: true
    autorestart: always
    exitcodes: [0]
    startretries: 3
    starttime: 2
    stopsignal: TERM
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/ping_monitor.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/ping_monitor.stderr
    env:
      PING_TARGET: "8.8.8.8"
      PING_INTERVAL: "10"

  # Counter - useful one-shot or scheduled runs
  counter:
    cmd: "/bin/bash /goinfre/yel-mass/taskmaster/scripts/counter.sh"
    numprocs: 1
    umask: 022
    workingdir: /goinfre/yel-mass/taskmaster
    autostart: false
    autorestart: never
    exitcodes: [0]
    startretries: 3
    starttime: 1
    stopsignal: TERM
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/counter.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/counter.stderr
    env:
      COUNT_TO: "100"

  # Simple HTTP server - direct Python execution (1 process only!)
  http_server:
    cmd: "/usr/bin/python3 -u -m http.server 9000"
    numprocs: 1
    umask: 022
    workingdir: /goinfre/yel-mass/taskmaster
    autostart: false
    autorestart: always
    exitcodes: [0]
    startretries: 3
    starttime: 2
    stopsignal: TERM
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/http_server.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/http_server.stderr
    env:
      PYTHONUNBUFFERED: "1"

  # Test exit codes
  test_exit:
    cmd: "/bin/bash /goinfre/yel-mass/taskmaster/scripts/test_exit.sh"
    numprocs: 1
    umask: 026
    workingdir: /goinfre/yel-mass/taskmaster
    autostart: false
    autorestart: unexpected
    exitcodes: [0, 2]
    startretries: 3
    starttime: 10
    stopsignal: TERM
    stoptime: 5
    # stdout: /goinfre/yel-mass/taskmaster/logs/test_exit.stdout
    # stderr: /goinfre/yel-mass/taskmaster/logs/test_exit.stderr

  # Test working directory - verifies workingdir is set correctly
  test_workdir:
    cmd: "/bin/bash /goinfre/yel-mass/taskmaster/scripts/test_workdir.sh"
    numprocs: 1
    umask: 022
    workingdir: /tmp
    autostart: false
    autorestart: never
    exitcodes: [0]
    startretries: 1
    starttime: 1
    stopsignal: TERM
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/test_workdir.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/test_workdir.stderr

  test_workdir_2:
    cmd: "/bin/bash -c 'echo Working directory: $(pwd) && ls -la'"
    numprocs: 1
    umask: 022
    workingdir: /tmp
    autostart: true
    autorestart: always
    exitcodes: [0]
    startretries: 10
    starttime: 1
    stopsignal: TERM
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/test_workdir.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/test_workdir.stderr

  # Test umask - verifies umask is applied correctly before launching
  test_umask:
    cmd: "/bin/bash /goinfre/yel-mass/taskmaster/scripts/test_umask.sh"
    numprocs: 1
    umask: 077
    workingdir: /goinfre/yel-mass/taskmaster
    autostart: false
    autorestart: never
    exitcodes: [0]
    startretries: 1
    starttime: 1
    stopsignal: TERM
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/test_umask.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/test_umask.stderr

  # Test umask - verifies umask is applied correctly before launching
  test_umask_2:
    cmd: "/bin/bash -c 'echo Current umask: $(umask) && touch /tmp/umask_test_file_$$ && ls -la /tmp/umask_test_file_$$ && rm /tmp/umask_test_file_$$'"
    numprocs: 1
    umask: 077
    workingdir: /goinfre/yel-mass/taskmaster
    autostart: false
    autorestart: never
    exitcodes: [0]
    startretries: 1
    starttime: 1
    stopsignal: TERM
    stoptime: 5
    stdout: /goinfre/yel-mass/taskmaster/logs/test_umask.stdout
    stderr: /goinfre/yel-mass/taskmaster/logs/test_umask.stderr
